
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Why the PHP Interactive Shell Isn&#8217;t a REPL, and Why It Is Lacking - Dev and Such</title>
  <meta name="author" content="Brian Zwahr">

  
  <meta name="description" content="After a recent conversation on Twitter, I felt like I should explain why I feel that php -a, the PHP Interactive Shell, isn&rsquo;t a REPL, and where &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://echosa.github.io/blog/2012/10/10/why-php-a-isnt-a-repl">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Dev and Such" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Dev and Such</a></h1>
  
    <h2>A blog pertaining to my own development experiences.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="echosa.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/blog/categories/php">PHP</a></li>
  <li><a href="/blog/categories/java">Java</a></li>
  <li><a href="/blog/categories/clojure">Clojure</a></li>
  <li><a href="/blog/categories/ios">iOS</a></li>
  <li><a href="/blog/categories/node-js">Node.js</a></li>
  <li><a href="/blog/categories/emacs">Emacs</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Why the PHP Interactive Shell Isn&#8217;t a REPL, and Why It Is Lacking</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-10-10T09:23:00-05:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>10</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>9:23 am</span></time>
        
           | <a href="#disqus_thread"
             data-disqus-identifier="http://echosa.github.io">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>After a recent conversation on Twitter, I felt like I should explain why I feel that <code>php -a</code>, the PHP Interactive Shell, isn&rsquo;t a REPL, and where it falls short because of this.</p>

<!--more-->


<p>First, a disclaimer: I will be giving a local talk on REPLs later this month, so if you will be attending that, there&rsquo;s no need to read further. I&rsquo;ll be going over pretty much everything in this post during my talk, so please, come by and attend! <em>end shameless self-promotion</em></p>

<p>&hellip;</p>

<p>Still here? OK, then. Moving on.</p>

<p>Let us start with a definition of sorts. REPL stands for Read-Eval-Print-Loop. A REPL is a program that reads input, evaluates what it read, prints the result (and possibly any output, and yes, there is a difference), then loops back to the read stage awaiting more input to evaluate and print. Here&rsquo;s an example session in the REPL for ruby (irb):</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ irb
</span><span class='line'>1.9.2p320 :001 &gt; 1
</span><span class='line'> =&gt; 1 
</span><span class='line'>1.9.2p320 :002 &gt; 2
</span><span class='line'> =&gt; 2 
</span><span class='line'>1.9.2p320 :003 &gt; 1+2
</span><span class='line'> =&gt; 3 
</span><span class='line'>1.9.2p320 :004 &gt; ohai
</span><span class='line'>NameError: undefined local variable or method `ohai' for main:Object
</span><span class='line'>           from (irb):4
</span><span class='line'>           from /Users/bzwahr/.rvm/rubies/ruby-1.9.2-p320/bin/irb:16:in `&lt;main&gt;'
</span><span class='line'>1.9.2p320 :005 &gt; "ohai"
</span><span class='line'> =&gt; "ohai" 
</span><span class='line'>1.9.2p320 :006 &gt; print "ohai"
</span><span class='line'>ohai =&gt; nil 
</span><span class='line'>1.9.2p320 :007 &gt; def printOhaiAndReturn42
</span><span class='line'>1.9.2p320 :008?&gt;   print "ohai"
</span><span class='line'>1.9.2p320 :009?&gt;   return 42
</span><span class='line'>1.9.2p320 :010?&gt;   end
</span><span class='line'> =&gt; nil 
</span><span class='line'>1.9.2p320 :011 &gt; printOhaiAndReturn42
</span><span class='line'>ohai =&gt; 42 
</span><span class='line'>1.9.2p320 :012 &gt; quit</span></code></pre></td></tr></table></div></figure>


<p>As you can see, the REPL takes the input, then prints the evaluation. Notice that the result of the evaluation is printed after a double arrow (=>). irb makes a distinction between result and output using the double arrow. In the example I define a function that prints a string (ohai) and returns a number (42). Running the function results in <code>ohai =&gt; 42</code>, showing us that <code>42</code> is the <em>result</em> of the evaluation while <code>ohai</code> is what would be output (in this case to stdin). We also see an error when I try to evaluate the string <code>ohai</code> without quotes. The REPL tries to evaluate it as a variable or function, which of course it isn&rsquo;t, and gives us an error stating this.</p>

<p>This is a typical REPL. Some REPLs are different. For instance, python doesn&rsquo;t show different result and output values. Different REPLs handle multiline input (like when I defined the printOhaiAndReturn42 function, above) in different ways.</p>

<p>The PHP Interactive Shell is not typical REPL. I dare say its not a REPL at all. Here&rsquo;s a similar session to the irb example above, this time in the PHP Interactive Shell:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ php -a
</span><span class='line'>Interactive shell
</span><span class='line'>
</span><span class='line'>php &gt; 1
</span><span class='line'>php &gt; 2
</span><span class='line'>php &gt; 1+2
</span><span class='line'>php &gt; ohai
</span><span class='line'>php &gt; "ohai"
</span><span class='line'>php &gt; print "ohai"
</span><span class='line'>php &gt; 1;
</span><span class='line'>PHP Parse error:  syntax error, unexpected '2' (T_LNUMBER) in php shell code on line 2
</span><span class='line'>
</span><span class='line'>Parse error: syntax error, unexpected '2' (T_LNUMBER) in php shell code on line 2
</span><span class='line'>
</span><span class='line'>php &gt; 2;
</span><span class='line'>php &gt; print "ohai";
</span><span class='line'>ohaiphp &gt; function printOhaiAndReturn42 () {
</span><span class='line'>php { print "ohai";
</span><span class='line'>php { return 42;
</span><span class='line'>php { }
</span><span class='line'>php &gt; printOhaiAndReturn42();
</span><span class='line'>ohaiphp &gt; 
</span><span class='line'>php &gt; 1
</span><span class='line'>php &gt; +2
</span><span class='line'>php &gt; +3;
</span><span class='line'>php &gt; print 1
</span><span class='line'>php &gt; +2
</span><span class='line'>php &gt; +3;
</span><span class='line'>6php &gt; quit</span></code></pre></td></tr></table></div></figure>


<p>Right off the bat, you should notice two things: there&rsquo;s a lot less printing going on, and when something is printed there&rsquo;s no implicit newline (meaning the printed output is immediately followed by the next prompt). A larger but less immediately noticeable difference is that the shell requires a semicolon at the end of its statements (not a shock since this is PHP), so the first seven lines of the example are all evaluated as one statement (which is obviously invalid, thus the following error). This is also demonstrated on the last four lines, where I evaluate <code>print 1+2+3;</code> on several lines, thus getting 6 as output. The three lines prior to those, I make the same arithmetic evaluation but without calling <code>print</code>, which means I don&rsquo;t actually see my output.</p>

<p>This leads to a big issue with the shell. It doesn&rsquo;t let you know via the prompt that you&rsquo;re continuing the same statement as the previous line(s). Notice that when I defined the function, the prompt changed to have an opening curly brace while I was inside the function defining it. That&rsquo;s nice, and you can see that irb did something similar by adding a question mark to the prompt. Of course, you would think that as long as the shell doesn&rsquo;t show you any output or results that you could implicitly know that you are continuing a multiline statement. However, since the shell doesn&rsquo;t output anything even after a statement is ended with a semicolon, unless you explicitly told it to <code>echo</code> or <code>print</code>, that&rsquo;s just not true.</p>

<p>So, I&rsquo;ve come to the conclusion that the PHP Interactive Shell isn&rsquo;t a REPL, its a REL. There&rsquo;s no implicit or expected Print stage of the loop, as there is in a typical REPL.</p>

<p>Also, in order to be called a REPL, you should be able to input any valid statement, variable, scalar, etc. and have it evaluated (with or without a semicolon). If I put <code>1</code> in, I should get <code>1</code> returned and see that return value printed by the REPL. Sure, there&rsquo;s no semicolon, but when PHP is evaluating something like <code>print 1+2;</code>, it still has to evaluate what <code>1</code> and <code>2</code> are individually in order to treat them properly. This, of course, would require the Interactive Shell to make one of two changes: either force all regular statements (not class or function definitions, for instance) to be on a single line (thus removing the need for an ending semicolon as it it would be implied), or add some way of specifying that you want to continue this statement on the next line (like using \ in multiline bash calls). If the latter is the solution, then the prompt should definitely reflect this. I think I would prefer the former, since that is how most typical REPLs work. What you put as input, unless it is something that absolutely requires more input (like a function call without a closing parenthesis or a class or function definition that hasn&rsquo;t been closed with a closing curly brace yet) is immediately evaluated when you press return. Want to evaluate 1+2+3 like in the example? Then input <code>1+2+3</code> all on one line.</p>

<p>There&rsquo;s more to REPLs and the Interactive Shell than this, of course. This was just a quick overview of why I feel the PHP Interactive Shell is lacking. That&rsquo;s not to say it is a useless tool. It has its place and uses, but I would like to see it be an actual REPL instead.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Brian Zwahr</span></span>

      




<time class='entry-date' datetime='2012-10-10T09:23:00-05:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>10</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>9:23 am</span></time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/php/'>php</a>, <a class='category' href='/blog/categories/repl/'>repl</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://echosa.github.io/blog/2012/10/10/why-php-a-isnt-a-repl/" data-via="echosa" data-counturl="http://echosa.github.io/blog/2012/10/10/why-php-a-isnt-a-repl/" >Tweet</a>
  
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2012/10/08/cli-emacs-and-multiple-frames/" title="Previous Post: CLI Emacs and multiple-frames">&laquo; CLI Emacs and multiple-frames</a>
      
      
        <a class="basic-alignment right" href="/blog/2012/10/16/kill-multiple-lines-with-kill-lines/" title="Next Post: Kill Multiple Lines with kill-lines">Kill Multiple Lines with kill-lines &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    
<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/echosa">@echosa</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'echosa',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/echosa" class="twitter-follow-button" data-show-count="false">Follow @echosa</a>
  
</section>

<section>
  <h1>Presentations</h1>
  You can view slides from presentations I&#8217;ve given <a href="https://speakerdeck.com/echosa">here on Speaker Deck</a>.
</section>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Brian Zwahr -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'devstuff-blog';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://echosa.github.io/blog/2012/10/10/why-php-a-isnt-a-repl/';
        var disqus_url = 'http://echosa.github.io/blog/2012/10/10/why-php-a-isnt-a-repl/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
